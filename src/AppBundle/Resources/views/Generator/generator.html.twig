{% form_theme form 'AppBundle::form_layout.html.twig' %}
{% extends 'AppBundle::layout.html.twig' %}

{% set activePage = 'generator' %}
{% block pageTitle %} - Generator{% endblock %}

{% set formGroupClass = 'group' %}

{% block body %}
    <form method="post" id="generator" action="{{ path('generator') }}">
        <div class="row">
            {{ form_errors(form) }}
        </div>

        <div class="row config-row">
            <div class="col-md-12">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title">Global configuration</h3>
                    </div>
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-md-6">
                                {{ form_row(form.name) }}
                            </div>
                            <div class="col-md-6">
                                {{ form_row(form.basePort) }}
                            </div>
                        </div>

                        <div class="row config-row-inner">
                            <div class="col-md-6">
                                {{ form_row(form.applicationOptions.applicationType) }}
                            </div>
                            <div class="col-md-6">
                                {{ form_row(form.applicationOptions.uploadSize) }}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row config-row">
            <div class="col-md-12">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title">PHP configuration</h3>
                    </div>
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-md-6">
                                {{ form_row(attribute(form.phpOptions, 'version')) }}
                                {{ form_row(attribute(form.phpOptions, 'hasGit')) }}

                                <p class="text-muted"><em>Please note:</em></p>

                                <ul class="text-muted">
                                    <li><em>The following extensions are already included on the base image: APC, cURL, JSON, MCrypt (sodium in PHP>=7.1), MBString, OPCache, Readline, XML and Zip.</em></li>
                                    <li><em>Each PHP version supports a different set of extensions to the others.</em></li>
                                    <li><em>Adding git to the container adds ~75MB to it.</em></li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                {{ form_row(attribute(form.phpOptions, 'phpExtensions72')) }}

                                {{ form_row(attribute(form.phpOptions, 'phpExtensions71')) }}

                                {{ form_row(attribute(form.phpOptions, 'phpExtensions70')) }}

                                {{ form_row(attribute(form.phpOptions, 'phpExtensions56')) }}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row config-row">
            <div class="col-md-6">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title">MySQL</h3>
                    </div>
                    <div class="panel-body">
                        {{ form_widget(attribute(form.mysqlOptions, 'hasMysql')) }}

                        <div id="mysql-options">
                            {% for field in ['version', 'rootPassword', 'databaseName', 'username', 'password'] %}
                                {% if (attribute(form.mysqlOptions, field) is defined) %}
                                    <div class="row config-row-inner">
                                        {{ form_row(attribute(form.mysqlOptions, field)) }}
                                    </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title">MariaDB</h3>
                    </div>
                    <div class="panel-body">
                        {{ form_widget(attribute(form.mariadbOptions, 'hasMariadb')) }}

                        <div id="mariadb-options">
                            {% for field in ['version', 'rootPassword', 'databaseName', 'username', 'password'] %}
                                {% if (attribute(form.mariadbOptions, field) is defined) %}
                                    <div class="row config-row-inner">
                                        {{ form_row(attribute(form.mariadbOptions, field)) }}
                                    </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row config-row">
            <div class="col-md-6">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title">Postgres</h3>
                    </div>
                    <div class="panel-body">
                        {{ form_widget(attribute(form.postgresOptions, 'hasPostgres')) }}

                        <div id="postgres-options">
                            {% for field in ['version', 'rootUser', 'rootPassword', 'databaseName'] %}
                                {% if (attribute(form.postgresOptions, field) is defined) %}
                                    <div class="row config-row-inner">
                                        {{ form_row(attribute(form.postgresOptions, field)) }}
                                    </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title">Elasticsearch</h3>
                    </div>
                    <div class="panel-body">
                        {{ form_widget(attribute(form.elasticsearchOptions, 'hasElasticsearch')) }}
                        <div id="elasticsearch-options">
                            {{ form_row(attribute(form.elasticsearchOptions, 'version')) }}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row config-row">
            <div class="col-md-6 col-md-offset-3">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title">Zero-config Services</h3>
                    </div>
                    <div class="panel-body">
                        <small>The following services take no additional configuration parameters.</small>

                        {% for field in ['hasMemcached', 'hasRedis', 'hasMailhog', 'hasClickhouse']
                            if (attribute(form, field) is defined) %}
                            <div class="form-group">{{ form_widget(attribute(form, field)) }}</div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>

        {{ form_rest(form) }}

        <div class="row">
            <div class="text-center">
                <input type="submit" class="btn btn-primary" value="Generate project archive">
            </div>
        </div>
    </form>
{% endblock %}

{% block bodys %}
    <form method="post" id="generator" action="{{ path('generator') }}">

        <div class="row">
            <div class="{{ formGroupClass }} col col-md-6 col-md-offset-3 col-lg-6 col-lg-offset-3 col-sm-12 col-xs-12">
                <h3>Zero-config Services</h3>
                <p class="note">The following services take no additional configuration parameters.</p>

                {% for field in ['hasMemcached', 'hasRedis', 'hasMailhog', 'hasClickhouse']
                if (attribute(form, field) is defined) %}
                    <div class="form-group">{{ form_widget(attribute(form, field)) }}</div>
                {% endfor %}
            </div>
        </div>

        {{ form_rest(form) }}

        <div class="row">
            <div class="col col-lg-4 col-lg-offset-4">
                <div class="text-center">
                    <input type="submit" class="btn button-custom btn-custom-three shadow"
                           value="Generate project archive">
                </div>
            </div>
        </div>
    </form>
{% endblock %}
